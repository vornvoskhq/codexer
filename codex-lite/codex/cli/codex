#!/bin/bash
# Resolve the absolute path to this script
SCRIPT_PATH="$(readlink -f "${BASH_SOURCE[0]}")"
SCRIPT_DIR="$(dirname "$SCRIPT_PATH")"

# Navigate to the codex-lite root directory
CODEX_ROOT="$(dirname "$(dirname "$SCRIPT_DIR")")"
VENV_PYTHON="$CODEX_ROOT/.venv/bin/python3"

if [ ! -x "$VENV_PYTHON" ]; then
  echo "Error: Python executable not found at $VENV_PYTHON"
  echo "Debug: SCRIPT_PATH=$SCRIPT_PATH"
  echo "Debug: SCRIPT_DIR=$SCRIPT_DIR"
  echo "Debug: CODEX_ROOT=$CODEX_ROOT"
  exit 1
fi

# Add the codex-lite root to Python path so imports work
export PYTHONPATH="$CODEX_ROOT:$PYTHONPATH"
exec "$VENV_PYTHON" "$SCRIPT_DIR/main.py" "$@"
